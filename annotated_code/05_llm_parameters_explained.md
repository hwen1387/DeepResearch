# LLM ç”Ÿæˆå‚æ•°è¯¦è§£

> è§£é‡Š `01_react_agent_core.py` ç¬¬ 346-351 è¡Œçš„ LLM API è°ƒç”¨å‚æ•°

---

## ğŸ“Œ å®Œæ•´ä»£ç ç‰‡æ®µ

```python
chat_response = client.chat.completions.create(
    model=self.model,                                           # ä½¿ç”¨çš„æ¨¡å‹åç§°
    messages=messages,                                          # å¯¹è¯å†å²
    stop=["\n<tool_response>", "<tool_response>"],             # åœæ­¢æ ‡è®°
    temperature=self.llm_generate_cfg.get('temperature', 0.6), # é‡‡æ ·æ¸©åº¦
    top_p=self.llm_generate_cfg.get('top_p', 0.95),           # æ ¸é‡‡æ ·æ¦‚ç‡
    max_tokens=10000,                                           # æœ€å¤§ç”Ÿæˆé•¿åº¦
    presence_penalty=self.llm_generate_cfg.get('presence_penalty', 1.1)  # å­˜åœ¨æƒ©ç½š
)
```

---

## ğŸ” é€è¡Œè¯¦è§£

### 1. `stop` å‚æ•° - åœæ­¢æ ‡è®°

```python
stop=["\n<tool_response>", "<tool_response>"]
```

#### ä½œç”¨
å‘Šè¯‰ LLM **ä½•æ—¶åœæ­¢ç”Ÿæˆ**ã€‚å½“ LLM ç”Ÿæˆçš„æ–‡æœ¬ä¸­å‡ºç°è¿™äº›å­—ç¬¦ä¸²æ—¶ï¼Œç«‹å³åœæ­¢ã€‚

#### ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªå‚æ•°ï¼Ÿ

**é—®é¢˜åœºæ™¯**ï¼š
```
Agent è°ƒç”¨å·¥å…·åï¼ŒæœŸæœ›çš„æµç¨‹ï¼š

1. LLM è¾“å‡ºå·¥å…·è°ƒç”¨ï¼š
   <tool_call>
   {"name": "search", "arguments": {...}}
   </tool_call>
   [LLM åœæ­¢ç”Ÿæˆ]

2. Agent æ‰§è¡Œå·¥å…·ï¼Œè¿”å›ï¼š
   <tool_response>
   æœç´¢ç»“æœ...
   </tool_response>

3. ç»§ç»­ä¸‹ä¸€è½®
```

**å¦‚æœæ²¡æœ‰ stop å‚æ•°**ï¼š
```
LLM å¯èƒ½ä¼šç»§ç»­ç”Ÿæˆï¼š

<tool_call>
{"name": "search", "arguments": {...}}
</tool_call>
<tool_response>     â† LLM è‡ªå·±ç¼–é€ çš„ï¼
å‡çš„æœç´¢ç»“æœ...    â† å¹»è§‰å†…å®¹ï¼
</tool_response>
```

#### ä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ªåœæ­¢æ ‡è®°ï¼Ÿ

```python
["\n<tool_response>", "<tool_response>"]
```

1. `"\n<tool_response>"` - å¸¦æ¢è¡Œç¬¦çš„ç‰ˆæœ¬
   - å¤„ç† LLM åœ¨æ–°è¡Œå¼€å§‹ç”Ÿæˆçš„æƒ…å†µ

2. `"<tool_response>"` - ä¸å¸¦æ¢è¡Œç¬¦çš„ç‰ˆæœ¬
   - å¤„ç† LLM åœ¨åŒä¸€è¡Œç»§ç»­ç”Ÿæˆçš„æƒ…å†µ

è¿™æ ·å¯ä»¥è¦†ç›–æ›´å¤šè¾¹ç•Œæƒ…å†µã€‚

#### å®é™…æ•ˆæœå¯¹æ¯”

**æœ‰ stop å‚æ•°**ï¼š
```
LLM ç”Ÿæˆ: "<tool_call>{"name": "search"}</tool_call>"
æ£€æµ‹åˆ°åœæ­¢æ ‡è®°: æ— 
ç»§ç»­ç”Ÿæˆ...

LLM å¼€å§‹ç”Ÿæˆ: "\n<tool_response>"
æ£€æµ‹åˆ°åœæ­¢æ ‡è®°: âœ“
ç«‹å³åœæ­¢
```

**æ—  stop å‚æ•°**ï¼š
```
LLM ç”Ÿæˆ: "<tool_call>{"name": "search"}</tool_call>\n<tool_response>å‡å†…å®¹</tool_response>"
å¹»è§‰å†…å®¹æ··å…¥ï¼
```

---

### 2. `temperature` å‚æ•° - é‡‡æ ·æ¸©åº¦

```python
temperature=self.llm_generate_cfg.get('temperature', 0.6)
```

#### ä½œç”¨
æ§åˆ¶ç”Ÿæˆçš„**éšæœºæ€§å’Œåˆ›é€ æ€§**ã€‚

#### å–å€¼èŒƒå›´å’Œæ•ˆæœ

```
0.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 0.6 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2.0
ç¡®å®šæ€§             å¹³è¡¡               åˆ›é€ æ€§             æ··ä¹±

æ¸©åº¦ = 0.0:
- æ¯æ¬¡ç”Ÿæˆå‡ ä¹ç›¸åŒ
- é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„è¯
- é€‚åˆäº‹å®æ€§ä»»åŠ¡
- ç¤ºä¾‹: "å·´é»æ˜¯æ³•å›½çš„é¦–éƒ½ã€‚" â† æ€»æ˜¯è¿™æ ·

æ¸©åº¦ = 0.6 (DeepResearch é»˜è®¤):
- å¹³è¡¡ç¡®å®šæ€§å’Œå¤šæ ·æ€§
- æ—¢å‡†ç¡®åˆæœ‰ä¸€å®šå˜åŒ–
- é€‚åˆ Agent ä»»åŠ¡
- ç¤ºä¾‹: "å·´é»æ˜¯æ³•å›½é¦–éƒ½ï¼Œä¹Ÿæ˜¯æœ€å¤§åŸå¸‚ã€‚"

æ¸©åº¦ = 1.0:
- è¾ƒé«˜çš„åˆ›é€ æ€§
- æ›´å¤šæ ·åŒ–çš„è¡¨è¾¾
- é€‚åˆåˆ›æ„å†™ä½œ
- ç¤ºä¾‹: "æ³•å›½çš„å¿ƒè„å·´é»ï¼Œè¿™åº§æµªæ¼«ä¹‹éƒ½..."

æ¸©åº¦ = 2.0:
- æé«˜éšæœºæ€§
- å¯èƒ½äº§ç”Ÿä¸è¿è´¯å†…å®¹
- ä¸æ¨èä½¿ç”¨
- ç¤ºä¾‹: "å·´é»...è‰¾è²å°”é“å¡”...å’–å•¡...è‰ºæœ¯..."
```

#### æ•°å­¦åŸç†

temperature è°ƒæ•´ softmax æ¦‚ç‡åˆ†å¸ƒï¼š

```python
# åŸå§‹æ¦‚ç‡ï¼ˆæœªè°ƒæ•´ï¼‰
logits = [3.0, 2.0, 1.0]  # "Paris", "London", "Rome"

# temperature = 1.0ï¼ˆæ ‡å‡†ï¼‰
probabilities = softmax(logits / 1.0)
# [0.67, 0.24, 0.09]  â† Paris 67% æ¦‚ç‡

# temperature = 0.1ï¼ˆä½æ¸©ï¼‰
probabilities = softmax(logits / 0.1)
# [0.98, 0.02, 0.00]  â† Paris 98% æ¦‚ç‡ï¼ˆæ›´ç¡®å®šï¼‰

# temperature = 2.0ï¼ˆé«˜æ¸©ï¼‰
probabilities = softmax(logits / 2.0)
# [0.46, 0.31, 0.23]  â† æ¦‚ç‡æ›´å¹³å‡ï¼ˆæ›´éšæœºï¼‰
```

#### DeepResearch ä¸ºä»€ä¹ˆé€‰æ‹© 0.6ï¼Ÿ

```python
# é»˜è®¤å€¼: 0.6
temperature=self.llm_generate_cfg.get('temperature', 0.6)
```

åŸå› ï¼š
1. âœ… **è¶³å¤Ÿç¡®å®š** - å·¥å…·è°ƒç”¨æ ¼å¼éœ€è¦å‡†ç¡®
2. âœ… **ä¸€å®šå¤šæ ·æ€§** - æ¢ç´¢ä¸åŒçš„æœç´¢ç­–ç•¥
3. âœ… **å¹³è¡¡æ€§èƒ½** - åœ¨å‡†ç¡®æ€§å’Œåˆ›é€ æ€§ä¹‹é—´å–å¾—å¹³è¡¡

---

### 3. `top_p` å‚æ•° - æ ¸é‡‡æ · (Nucleus Sampling)

```python
top_p=self.llm_generate_cfg.get('top_p', 0.95)
```

#### ä½œç”¨
æ§åˆ¶ç”Ÿæˆæ—¶è€ƒè™‘çš„**å€™é€‰è¯èŒƒå›´**ã€‚

#### å·¥ä½œåŸç†

top_p é‡‡æ ·ï¼ˆä¹Ÿç§°ä¸ºæ ¸é‡‡æ ·ï¼‰ï¼š
1. æŒ‰æ¦‚ç‡ä»é«˜åˆ°ä½æ’åºå€™é€‰è¯
2. ç´¯åŠ æ¦‚ç‡ç›´åˆ°è¾¾åˆ° p å€¼
3. åªä»è¿™ä¸ª"æ ¸å¿ƒé›†"ä¸­é‡‡æ ·

#### å¯è§†åŒ–ç¤ºä¾‹

```
å‡è®¾ä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒï¼š

è¯æ±‡          æ¦‚ç‡    ç´¯è®¡æ¦‚ç‡
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"capital"    0.40    0.40  â†
"city"       0.25    0.65  â†
"center"     0.20    0.85  â†
"hub"        0.10    0.95  â† top_p=0.95 è¾¹ç•Œ
"heart"      0.03    0.98  âœ— è¢«æ’é™¤
"soul"       0.02    1.00  âœ— è¢«æ’é™¤


top_p = 0.95 æ—¶:
- è€ƒè™‘å‰ 4 ä¸ªè¯ (capital, city, center, hub)
- ç´¯è®¡æ¦‚ç‡ = 95%
- åé¢çš„ä½æ¦‚ç‡è¯è¢«æ’é™¤

top_p = 0.5 æ—¶:
- åªè€ƒè™‘å‰ 2 ä¸ªè¯ (capital, city)
- ç´¯è®¡æ¦‚ç‡ = 65% (>50%)
- æ›´ä¿å®ˆçš„é€‰æ‹©

top_p = 1.0 æ—¶:
- è€ƒè™‘æ‰€æœ‰è¯
- æ— é™åˆ¶
```

#### ä¸ temperature çš„åŒºåˆ«

```
temperature:
- è°ƒæ•´æ¦‚ç‡åˆ†å¸ƒçš„å½¢çŠ¶
- å½±å“æ‰€æœ‰å€™é€‰è¯
- æ§åˆ¶"å¹³æ»‘åº¦"

top_p:
- é™åˆ¶å€™é€‰è¯çš„æ•°é‡
- åŠ¨æ€è°ƒæ•´è€ƒè™‘èŒƒå›´
- æ§åˆ¶"è¾¹ç•Œ"

ç»„åˆä½¿ç”¨:
1. temperature è°ƒæ•´æ¦‚ç‡
2. top_p é€‰æ‹©è€ƒè™‘èŒƒå›´
3. ä»èŒƒå›´å†…é‡‡æ ·
```

#### å®é™…æ•ˆæœå¯¹æ¯”

**top_p = 0.95 (DeepResearch é»˜è®¤)**ï¼š
```
è€ƒè™‘æ¦‚ç‡å‰ 95% çš„è¯
ç”Ÿæˆ: "Paris is the capital and largest city of France."
ç»“æœ: å‡†ç¡®ä¸”è‡ªç„¶
```

**top_p = 0.5 (æ›´ä¿å®ˆ)**ï¼š
```
åªè€ƒè™‘æ¦‚ç‡å‰ 50% çš„è¯
ç”Ÿæˆ: "Paris is the capital of France."
ç»“æœ: æ›´çŸ­ã€æ›´ç¡®å®šï¼Œä½†å¯èƒ½ç¼ºä¹ç»†èŠ‚
```

**top_p = 1.0 (æ— é™åˆ¶)**ï¼š
```
è€ƒè™‘æ‰€æœ‰å€™é€‰è¯
ç”Ÿæˆ: "Paris, the luminous heart of France, stands as..."
ç»“æœ: æ›´æœ‰åˆ›æ„ï¼Œä½†å¯èƒ½åç¦»ä¸»é¢˜
```

---

### 4. `max_tokens` å‚æ•° - æœ€å¤§ç”Ÿæˆé•¿åº¦

```python
max_tokens=10000
```

#### ä½œç”¨
é™åˆ¶ LLM **å•æ¬¡ç”Ÿæˆçš„æœ€å¤§ token æ•°é‡**ã€‚

#### Token æ˜¯ä»€ä¹ˆï¼Ÿ

Token æ˜¯æ–‡æœ¬çš„æœ€å°å•ä½ï¼Œå¤§è‡´ç›¸å½“äºï¼š
```
è‹±æ–‡: 1 token â‰ˆ 0.75 ä¸ªå•è¯
ä¸­æ–‡: 1 token â‰ˆ 0.5-1 ä¸ªæ±‰å­—

ç¤ºä¾‹:
"Hello world"     â†’ 2 tokens
"ä½ å¥½ä¸–ç•Œ"        â†’ 4 tokens
"DeepResearch"    â†’ 2-3 tokens
```

#### ä¸ºä»€ä¹ˆæ˜¯ 10000ï¼Ÿ

```python
max_tokens=10000  # çº¦ 7500 ä¸ªè‹±æ–‡å•è¯ï¼Œæˆ– 5000-10000 ä¸ªæ±‰å­—
```

**è®¾è®¡è€ƒè™‘**ï¼š

1. **å·¥å…·è°ƒç”¨å“åº”**ï¼š
   ```
   <think>
   æ€è€ƒå†…å®¹ (500-1000 tokens)
   </think>
   <tool_call>
   å·¥å…·è°ƒç”¨ (100-200 tokens)
   </tool_call>
   ```

2. **æœ€ç»ˆç­”æ¡ˆ**ï¼š
   ```
   <answer>
   è¯¦ç»†ç­”æ¡ˆ (2000-5000 tokens)
   </answer>
   ```

3. **å®‰å…¨è¾¹ç•Œ**ï¼š
   - é˜²æ­¢æ— é™ç”Ÿæˆ
   - é¿å…æµªè´¹è®¡ç®—èµ„æº
   - 10000 è¶³å¤Ÿå¤§ï¼Œä¸ä¼šæˆªæ–­æ­£å¸¸å“åº”

#### å®é™…åœºæ™¯

**åœºæ™¯ 1: å·¥å…·è°ƒç”¨ï¼ˆçŸ­ï¼‰**
```
ç”Ÿæˆå†…å®¹:
<think>ç”¨æˆ·æƒ³çŸ¥é“é‡å­è®¡ç®—ï¼Œæˆ‘åº”è¯¥æœç´¢</think>
<tool_call>
{"name": "search", "arguments": {"query": ["quantum computing"]}}
</tool_call>

å®é™… tokens: ~150
max_tokens: 10000
çŠ¶æ€: æ­£å¸¸å®Œæˆï¼ˆé‡åˆ° stop æ ‡è®°åœæ­¢ï¼‰
```

**åœºæ™¯ 2: æœ€ç»ˆç­”æ¡ˆï¼ˆé•¿ï¼‰**
```
ç”Ÿæˆå†…å®¹:
<answer>
é‡å­è®¡ç®—æ˜¯ä¸€ç§åˆ©ç”¨é‡å­åŠ›å­¦åŸç†çš„è®¡ç®—æ–¹å¼...
ï¼ˆè¯¦ç»†è§£é‡Š 3000 tokensï¼‰
</answer>

å®é™… tokens: ~3000
max_tokens: 10000
çŠ¶æ€: æ­£å¸¸å®Œæˆ
```

**åœºæ™¯ 3: å¼‚å¸¸æƒ…å†µï¼ˆè¶…é•¿ï¼‰**
```
å¦‚æœ LLM å¼€å§‹æ— é™é‡å¤æˆ–å¹»è§‰ï¼š
"é‡å­è®¡ç®—é‡å­è®¡ç®—é‡å­è®¡ç®—é‡å­è®¡ç®—..."

åˆ°è¾¾ tokens: 10000
çŠ¶æ€: è¢«æˆªæ–­
Agent: æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œè§¦å‘é”™è¯¯å¤„ç†
```

#### æ€§èƒ½å½±å“

```
max_tokens å¯¹æ¨ç†æ—¶é—´çš„å½±å“:

max_tokens=1000  â†’ ç”Ÿæˆæ—¶é—´: 5-10 ç§’
max_tokens=10000 â†’ ç”Ÿæˆæ—¶é—´: ä¸å˜ (æŒ‰éœ€ç”Ÿæˆ)
                   â†‘
                   æ³¨æ„: è¿™æ˜¯ä¸Šé™ï¼Œä¸å½±å“æ­£å¸¸å“åº”çš„é€Ÿåº¦
```

---

### 5. `presence_penalty` å‚æ•° - å­˜åœ¨æƒ©ç½š

```python
presence_penalty=self.llm_generate_cfg.get('presence_penalty', 1.1)
```

#### ä½œç”¨
æƒ©ç½š**å·²ç»å‡ºç°è¿‡çš„ token**ï¼Œé¼“åŠ±ç”Ÿæˆ**æ–°å†…å®¹**ã€‚

#### å·¥ä½œåŸç†

```
presence_penalty å·¥ä½œæœºåˆ¶:

1. LLM ç”Ÿæˆ token "Paris"
2. è®°å½•: {"Paris": å‡ºç°è¿‡}
3. ä¸‹æ¬¡é€‰è¯æ—¶:
   - "Paris" çš„ logit å‡å» presence_penalty
   - å…¶ä»–è¯ä¸å—å½±å“
4. ç»“æœ: "Paris" è¢«å†æ¬¡é€‰ä¸­çš„æ¦‚ç‡é™ä½
```

#### å–å€¼èŒƒå›´å’Œæ•ˆæœ

```
-2.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 0.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2.0
é¼“åŠ±é‡å¤       æ— å½±å“        å‡å°‘é‡å¤      å¼ºåˆ¶ä¸é‡å¤

presence_penalty = 0.0 (æ— æƒ©ç½š):
ç”Ÿæˆ: "Paris is beautiful. Paris is great. Paris is amazing."
æ•ˆæœ: å¯èƒ½é‡å¤

presence_penalty = 1.1 (DeepResearch é»˜è®¤):
ç”Ÿæˆ: "Paris is beautiful. The city offers amazing culture."
æ•ˆæœ: è‡ªç„¶å¤šæ ·ï¼Œå‡å°‘é‡å¤

presence_penalty = 2.0 (å¼ºæƒ©ç½š):
ç”Ÿæˆ: "Paris captivates visitors. France's capital mesmerizes tourists."
æ•ˆæœ: æåŠ›é¿å…é‡å¤è¯ï¼Œä½†å¯èƒ½ä¸è‡ªç„¶
```

#### ä¸ frequency_penalty çš„åŒºåˆ«

è™½ç„¶è¿™æ®µä»£ç æ²¡ç”¨ frequency_penaltyï¼Œä½†å€¼å¾—äº†è§£åŒºåˆ«ï¼š

```python
# presence_penalty
# - åªå…³å¿ƒæ˜¯å¦å‡ºç°è¿‡ï¼ˆ0 æˆ– 1ï¼‰
# - å‡ºç° 1 æ¬¡å’Œ 10 æ¬¡çš„æƒ©ç½šç›¸åŒ

# frequency_penalty
# - å…³å¿ƒå‡ºç°æ¬¡æ•°
# - å‡ºç°æ¬¡æ•°è¶Šå¤šï¼Œæƒ©ç½šè¶Šå¤§

ç¤ºä¾‹:
æ–‡æœ¬: "Paris Paris Paris London"

presence_penalty:
- "Paris": -1.1 (å‡ºç°è¿‡ï¼Œæƒ©ç½š)
- "London": -1.1 (å‡ºç°è¿‡ï¼Œæƒ©ç½š)
- "Rome": 0 (æœªå‡ºç°ï¼Œæ— æƒ©ç½š)

frequency_penalty (å‡è®¾=0.5):
- "Paris": -1.5 (å‡ºç° 3 æ¬¡ï¼Œæƒ©ç½š 3*0.5)
- "London": -0.5 (å‡ºç° 1 æ¬¡ï¼Œæƒ©ç½š 1*0.5)
- "Rome": 0 (æœªå‡ºç°ï¼Œæ— æƒ©ç½š)
```

#### DeepResearch ä¸ºä»€ä¹ˆé€‰æ‹© 1.1ï¼Ÿ

```python
presence_penalty=1.1  # è¾ƒé«˜çš„æƒ©ç½šå€¼
```

**åŸå› **ï¼š

1. **é¿å…å·¥å…·é‡å¤è°ƒç”¨**
   ```
   ä¸å¸Œæœ›:
   <tool_call>{"name": "search", "arguments": {"query": ["quantum"]}}</tool_call>
   <tool_call>{"name": "search", "arguments": {"query": ["quantum"]}}</tool_call>  â† é‡å¤ï¼

   æœŸæœ›:
   <tool_call>{"name": "search", "arguments": {"query": ["quantum computing"]}}</tool_call>
   <tool_call>{"name": "visit", "arguments": {"url": [...]}}</tool_call>  â† ä¸åŒå·¥å…·
   ```

2. **é¼“åŠ±å¤šæ ·åŒ–æ¢ç´¢**
   ```
   ä¸å¸Œæœ›:
   æœç´¢ "é‡å­è®¡ç®—"
   æœç´¢ "é‡å­è®¡ç®—è¿›å±•"  â† å¤ªç›¸ä¼¼

   æœŸæœ›:
   æœç´¢ "é‡å­è®¡ç®—"
   æœç´¢ "é‡å­çº ç¼ "  â† ç›¸å…³ä½†ä¸åŒ
   è®¿é—®å…·ä½“ç½‘é¡µ  â† ä¸åŒç­–ç•¥
   ```

3. **æé«˜ç­”æ¡ˆè´¨é‡**
   ```
   ä¸å¸Œæœ›:
   é‡å­è®¡ç®—æ˜¯...é‡å­è®¡ç®—å…·æœ‰...é‡å­è®¡ç®—èƒ½å¤Ÿ...  â† é‡å¤å¼€å¤´

   æœŸæœ›:
   é‡å­è®¡ç®—æ˜¯...è¿™é¡¹æŠ€æœ¯å…·æœ‰...å®ƒèƒ½å¤Ÿ...  â† å¤šæ ·è¡¨è¾¾
   ```

---

## ğŸ¯ å‚æ•°ç»„åˆç­–ç•¥

### DeepResearch çš„é€‰æ‹©

```python
{
    "temperature": 0.6,        # å¹³è¡¡å‡†ç¡®æ€§å’Œå¤šæ ·æ€§
    "top_p": 0.95,            # è€ƒè™‘é«˜æ¦‚ç‡è¯
    "max_tokens": 10000,      # è¶³å¤Ÿçš„å“åº”ç©ºé—´
    "presence_penalty": 1.1,  # é¿å…é‡å¤
    "stop": ["<tool_response>"]  # é˜²æ­¢å¹»è§‰
}
```

è¿™ä¸ªç»„åˆçš„ç‰¹ç‚¹ï¼š
- âœ… å·¥å…·è°ƒç”¨æ ¼å¼å‡†ç¡®
- âœ… æœç´¢ç­–ç•¥å¤šæ ·åŒ–
- âœ… é¿å…é‡å¤å’Œå¹»è§‰
- âœ… ç”Ÿæˆæµç•…è‡ªç„¶

---

## ğŸ”§ è°ƒä¼˜å»ºè®®

### ä¸åŒä»»åŠ¡çš„æ¨èå‚æ•°

#### 1. äº‹å®æ€§æŸ¥è¯¢ï¼ˆéœ€è¦å‡†ç¡®ï¼‰
```python
{
    "temperature": 0.3,        # â†“ é™ä½ï¼Œæé«˜ç¡®å®šæ€§
    "top_p": 0.9,             # â†“ é™ä½ï¼Œæ›´ä¿å®ˆ
    "presence_penalty": 0.8,  # â†“ é™ä½ï¼Œå…è®¸ä¸€å®šé‡å¤
    "max_tokens": 5000
}

é€‚åˆ: "2024 å¹´è¯ºè´å°”ç‰©ç†å­¦å¥–å¾—ä¸»æ˜¯è°ï¼Ÿ"
```

#### 2. æ¢ç´¢æ€§ç ”ç©¶ï¼ˆéœ€è¦å¤šæ ·æ€§ï¼‰
```python
{
    "temperature": 0.85,       # â†‘ æé«˜ï¼Œæ›´å¤šæ¢ç´¢
    "top_p": 0.95,            # ä¿æŒ
    "presence_penalty": 1.5,  # â†‘ æé«˜ï¼Œå¼ºåˆ¶å¤šæ ·åŒ–
    "max_tokens": 10000
}

é€‚åˆ: "è°ƒç ”é‡å­è®¡ç®—çš„åº”ç”¨åœºæ™¯"
```

#### 3. åˆ›æ„å†™ä½œï¼ˆéœ€è¦åˆ›é€ æ€§ï¼‰
```python
{
    "temperature": 1.0,        # â†‘â†‘ å¤§å¹…æé«˜
    "top_p": 0.98,            # â†‘ æé«˜ï¼Œè€ƒè™‘æ›´å¤šå¯èƒ½
    "presence_penalty": 1.8,  # â†‘â†‘ å¤§å¹…æé«˜ï¼Œé¿å…é‡å¤
    "max_tokens": 15000
}

é€‚åˆ: "å†™ä¸€ç¯‡å…³äºé‡å­è®¡ç®—çš„ç§‘æ™®æ–‡ç« "
```

#### 4. ä»£ç ç”Ÿæˆï¼ˆéœ€è¦ç²¾ç¡®ï¼‰
```python
{
    "temperature": 0.2,        # â†“â†“ å¤§å¹…é™ä½
    "top_p": 0.85,            # â†“ é™ä½
    "presence_penalty": 0.5,  # â†“ é™ä½ï¼Œä»£ç å¯èƒ½éœ€è¦é‡å¤ç»“æ„
    "max_tokens": 8000
}

é€‚åˆ: "ç”¨ Python å®ç°å¿«é€Ÿæ’åº"
```

---

## ğŸ“Š å‚æ•°æ•ˆæœå¯è§†åŒ–

### Temperature æ•ˆæœ

```
é—®é¢˜: "é‡å­è®¡ç®—çš„åº”ç”¨"

temperature=0.1:
å›ç­”: é‡å­è®¡ç®—åœ¨å¯†ç å­¦ä¸­æœ‰åº”ç”¨ã€‚é‡å­è®¡ç®—åœ¨è¯ç‰©ç ”å‘ä¸­æœ‰åº”ç”¨ã€‚
      â†‘ é‡å¤ç»“æ„ï¼Œç¼ºä¹å˜åŒ–

temperature=0.6:
å›ç­”: é‡å­è®¡ç®—åœ¨å¯†ç å­¦é¢†åŸŸå±•ç°å‡ºå·¨å¤§æ½œåŠ›ã€‚æ­¤å¤–ï¼Œå®ƒåœ¨è¯ç‰©è®¾è®¡æ–¹é¢ä¹Ÿæœ‰é‡è¦åº”ç”¨ã€‚
      â†‘ å¹³è¡¡ï¼Œæ—¢å‡†ç¡®åˆæœ‰å˜åŒ–

temperature=1.2:
å›ç­”: é‡å­è®¡ç®—ï¼Œè¿™ä¸ªç¥å¥‡çš„é¢†åŸŸï¼ä»ç ´è§£å¯†ç åˆ°è®¾è®¡æ–°è¯ï¼Œæ— æ‰€ä¸èƒ½ï¼
      â†‘ åˆ›æ„ä½†å¯èƒ½å¤¸å¼ 
```

### Presence Penalty æ•ˆæœ

```
é—®é¢˜: "ä»‹ç»å·´é»çš„ä¸‰ä¸ªç‰¹ç‚¹"

presence_penalty=0.0:
å·´é»æœ‰åŸƒè²å°”é“å¡”ã€‚å·´é»æœ‰å¢æµ®å®«ã€‚å·´é»æœ‰å‡¯æ—‹é—¨ã€‚
â†‘ "å·´é»" é‡å¤ 3 æ¬¡

presence_penalty=1.1:
å·´é»æœ‰åŸƒè²å°”é“å¡”ã€‚è¿™åº§åŸå¸‚è¿˜æ‹¥æœ‰å¢æµ®å®«ã€‚æ­¤å¤–ï¼Œå‡¯æ—‹é—¨ä¹Ÿå¾ˆè‘—åã€‚
â†‘ ç”¨ "è¿™åº§åŸå¸‚"ã€"æ­¤å¤–" æ›¿ä»£ï¼Œæ›´è‡ªç„¶

presence_penalty=2.0:
é¦–å…ˆæ˜¯åŸƒè²å°”é“å¡”ã€‚å…¶æ¬¡ï¼Œæ³•å›½é¦–éƒ½å±•ç¤ºäº†å¢æµ®å®«ã€‚ç¬¬ä¸‰ï¼Œè®¿å®¢èƒ½æ¬£èµåˆ°å‡¯æ—‹é—¨ã€‚
â†‘ æåŠ›é¿å…é‡å¤ï¼Œå¯èƒ½æœ‰ç‚¹åˆ»æ„
```

---

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯ 1: temperature è¿‡é«˜

```python
# âŒ é”™è¯¯
temperature=2.0

ç»“æœ:
<tool_call>
{"name": "quantum", "search": "computing", "maybe": "???"}
</tool_call>
â†‘ JSON æ ¼å¼æ··ä¹±
```

### é”™è¯¯ 2: max_tokens è¿‡å°

```python
# âŒ é”™è¯¯
max_tokens=100

ç»“æœ:
<answer>
é‡å­è®¡ç®—æ˜¯ä¸€ç§åˆ©ç”¨é‡å­åŠ›å­¦åŸç†çš„...  â† è¢«æˆªæ–­
```

### é”™è¯¯ 3: ç¼ºå°‘ stop å‚æ•°

```python
# âŒ é”™è¯¯
# æ²¡æœ‰ stop å‚æ•°

ç»“æœ:
<tool_call>{"name": "search"}</tool_call>
<tool_response>å‡çš„æœç´¢ç»“æœ</tool_response>  â† LLM è‡ªå·±ç¼–çš„ï¼
```

### é”™è¯¯ 4: presence_penalty è¿‡é«˜

```python
# âŒ é”™è¯¯
presence_penalty=5.0

ç»“æœ:
"Paris capital France metropolis urban center municipality..."
â†‘ ä¸ºäº†é¿å…é‡å¤ï¼Œä½¿ç”¨è¿‡å¤šåŒä¹‰è¯ï¼Œä¸è‡ªç„¶
```

---

## ğŸ§ª å®éªŒï¼šè°ƒæ•´å‚æ•°è§‚å¯Ÿæ•ˆæœ

### å®éªŒä»£ç 

```python
def test_parameters():
    configs = [
        {"name": "ä¿å®ˆ", "temperature": 0.3, "top_p": 0.85, "presence_penalty": 0.5},
        {"name": "é»˜è®¤", "temperature": 0.6, "top_p": 0.95, "presence_penalty": 1.1},
        {"name": "åˆ›æ„", "temperature": 1.0, "top_p": 0.98, "presence_penalty": 1.5},
    ]

    question = "ä»‹ç»é‡å­è®¡ç®—çš„ä¸‰ä¸ªåº”ç”¨"

    for config in configs:
        print(f"\n{'='*60}")
        print(f"é…ç½®: {config['name']}")
        print(f"{'='*60}")

        response = client.chat.completions.create(
            model="deepresearch",
            messages=[{"role": "user", "content": question}],
            temperature=config["temperature"],
            top_p=config["top_p"],
            presence_penalty=config["presence_penalty"],
            max_tokens=500
        )

        print(response.choices[0].message.content)
```

---

## ğŸ“ æ€»ç»“

| å‚æ•° | é»˜è®¤å€¼ | ä½œç”¨ | è°ƒä¼˜æ–¹å‘ |
|------|--------|------|----------|
| `stop` | `["<tool_response>"]` | é˜²æ­¢å¹»è§‰ | æ ¹æ®æ ¼å¼æ·»åŠ åœæ­¢æ ‡è®° |
| `temperature` | `0.6` | æ§åˆ¶éšæœºæ€§ | å‡†ç¡®ä»»åŠ¡â†“ï¼Œåˆ›æ„ä»»åŠ¡â†‘ |
| `top_p` | `0.95` | é™åˆ¶å€™é€‰è¯ | ä¿å®ˆä»»åŠ¡â†“ï¼Œæ¢ç´¢ä»»åŠ¡â†‘ |
| `max_tokens` | `10000` | é™åˆ¶é•¿åº¦ | æ ¹æ®é¢„æœŸå“åº”é•¿åº¦è°ƒæ•´ |
| `presence_penalty` | `1.1` | é¿å…é‡å¤ | éœ€è¦é‡å¤â†“ï¼Œå¤šæ ·æ€§â†‘ |

**æ ¸å¿ƒåŸåˆ™**ï¼š
1. ä»é»˜è®¤å€¼å¼€å§‹
2. ä¸€æ¬¡åªè°ƒæ•´ä¸€ä¸ªå‚æ•°
3. è§‚å¯Ÿè¾“å‡ºå˜åŒ–
4. é€æ­¥ä¼˜åŒ–åˆ°æœ€ä½³

å¸Œæœ›è¿™ä¸ªè¯¦ç»†çš„è§£é‡Šå¯¹æ‚¨æœ‰å¸®åŠ©ï¼ğŸ“
